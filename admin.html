<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ARM Energy — Admin Dashboard</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/icon.svg" type="image/svg+xml">
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&family=IBM+Plex+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#0a0e14;--surface:#0f1520;--surface2:#141e2e;--border:#1e2d3d;--border2:#243547;--text:#e2e8f0;--text-dim:#94a3b8;--text-muted:#475569;--accent:#22d3ee;--accent2:#06b6d4;--green:#10b981;--red:#ef4444;--amber:#f59e0b;--font-mono:'IBM Plex Mono',monospace;--font-sans:'IBM Plex Sans',sans-serif;--radius:8px;--transition:0.2s ease}
[data-theme="medium"]{--bg:#1a1f2e;--surface:#242938;--surface2:#2d3344;--border:#3d4455;--border2:#4d5566;--text:#e2e8f0;--text-dim:#a0aec0;--text-muted:#718096}
[data-theme="light"]{--bg:#f1f5f9;--surface:#ffffff;--surface2:#f8fafc;--border:#e2e8f0;--border2:#cbd5e1;--text:#1e293b;--text-dim:#475569;--text-muted:#94a3b8}
body{font-family:var(--font-sans);background:var(--bg);color:var(--text);line-height:1.5;min-height:100vh;display:flex}
.sidebar{width:220px;background:var(--surface);border-right:1px solid var(--border);display:flex;flex-direction:column;position:fixed;top:0;left:0;bottom:0;z-index:100}
.sidebar-header{padding:20px 16px;border-bottom:1px solid var(--border)}
.logo{font-family:var(--font-mono);font-size:18px;font-weight:700;letter-spacing:-0.5px}
.logo-energy{color:var(--accent)}.logo-desk{color:var(--text-dim)}
.logo-img-sm{height:28px;display:block}
[data-theme="medium"] .logo-img-sm{filter:drop-shadow(0 0 1px rgba(255,255,255,0.6))}
:root .logo-img-sm{filter:drop-shadow(0 0 1px rgba(255,255,255,0.6))}
[data-theme="light"] .logo-img-sm{filter:none}
.logo-img-login{height:40px;display:block;margin:0 auto}
.admin-badge{display:inline-block;background:var(--accent);color:#000;font-size:10px;font-weight:700;padding:2px 6px;border-radius:3px;margin-left:8px;letter-spacing:1px}
.sidebar-nav{flex:1;padding:12px 0}
.nav-item{display:flex;align-items:center;gap:10px;padding:10px 16px;color:var(--text-dim);cursor:pointer;transition:all var(--transition);font-size:14px;position:relative;border:none;background:none;width:100%;text-align:left;font-family:inherit}
.nav-item:hover{color:var(--text);background:var(--surface2)}.nav-item.active{color:var(--accent);background:var(--surface2);border-right:3px solid var(--accent)}
.nav-item svg{width:18px;height:18px;flex-shrink:0}
.nav-badge{position:absolute;right:12px;background:var(--red);color:#fff;font-size:10px;font-weight:700;min-width:18px;height:18px;border-radius:9px;display:flex;align-items:center;justify-content:center;padding:0 5px}
.sidebar-footer{padding:12px 16px;border-top:1px solid var(--border);display:flex;flex-direction:column;gap:8px}
.server-status{font-size:12px;color:var(--text-dim);display:flex;align-items:center;gap:6px}
.status-dot{width:8px;height:8px;border-radius:50%;background:var(--green);flex-shrink:0}.status-dot.offline{background:var(--red)}.status-dot.reconnecting{background:var(--amber)}
.theme-selector{display:flex;gap:4px}
.theme-btn{flex:1;padding:4px;border:1px solid var(--border);border-radius:4px;background:transparent;color:var(--text-dim);font-size:11px;cursor:pointer;font-family:inherit;transition:all var(--transition)}
.theme-btn:hover{border-color:var(--accent);color:var(--text)}.theme-btn.active{background:var(--accent);color:#000;border-color:var(--accent)}
.logout-btn{background:transparent;border:1px solid var(--border);color:var(--text-dim);padding:6px 12px;border-radius:var(--radius);cursor:pointer;font-size:12px;font-family:inherit;transition:all var(--transition)}
.logout-btn:hover{border-color:var(--red);color:var(--red)}
.main{margin-left:220px;flex:1;padding:24px;min-height:100vh}
.page-header{margin-bottom:24px}.page-header h1{font-size:24px;font-weight:700;margin-bottom:4px}.page-header p{color:var(--text-dim);font-size:14px}
.summary-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:16px;margin-bottom:24px}
.summary-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:16px}
.summary-card .label{font-size:12px;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.5px;margin-bottom:4px}
.summary-card .value{font-size:28px;font-weight:700;font-family:var(--font-mono)}
.summary-card .value.green{color:var(--green)}.summary-card .value.red{color:var(--red)}.summary-card .value.amber{color:var(--amber)}
.card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);margin-bottom:16px}
.card-header{padding:16px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.card-header h3{font-size:16px;font-weight:600}.card-body{padding:16px}
.form-row{display:flex;gap:12px;margin-bottom:12px;align-items:flex-end}
.form-group{display:flex;flex-direction:column;gap:4px;flex:1}
.form-group label{font-size:12px;color:var(--text-dim);font-weight:500}
input,select,textarea{background:var(--surface2);border:1px solid var(--border);border-radius:6px;padding:8px 12px;color:var(--text);font-family:inherit;font-size:14px;outline:none;transition:border-color var(--transition)}
input:focus,select:focus,textarea:focus{border-color:var(--accent)}
input[type="color"]{padding:2px;height:36px;width:60px;cursor:pointer}
.btn{display:inline-flex;align-items:center;gap:6px;padding:8px 16px;border:none;border-radius:6px;font-family:inherit;font-size:13px;font-weight:500;cursor:pointer;transition:all var(--transition);white-space:nowrap}
.btn-primary{background:var(--accent);color:#000}.btn-primary:hover{background:var(--accent2)}
.btn-success{background:var(--green);color:#fff}.btn-success:hover{opacity:0.9}
.btn-danger{background:var(--red);color:#fff}.btn-danger:hover{opacity:0.9}
.btn-warning{background:var(--amber);color:#000}.btn-warning:hover{opacity:0.9}
.btn-ghost{background:transparent;border:1px solid var(--border);color:var(--text-dim)}.btn-ghost:hover{border-color:var(--text-dim);color:var(--text)}
.btn-sm{padding:4px 10px;font-size:12px}.btn:disabled{opacity:0.5;cursor:not-allowed}
.table-wrap{overflow-x:auto}
table{width:100%;border-collapse:collapse;font-size:13px}
th{text-align:left;padding:10px 12px;font-size:11px;text-transform:uppercase;letter-spacing:0.5px;color:var(--text-muted);border-bottom:1px solid var(--border);white-space:nowrap}
td{padding:10px 12px;border-bottom:1px solid var(--border);vertical-align:middle}
tr:hover td{background:var(--surface2)}
.badge{display:inline-block;padding:2px 8px;border-radius:4px;font-size:11px;font-weight:600;letter-spacing:0.5px}
.badge-active{background:rgba(16,185,129,0.15);color:var(--green)}.badge-pending{background:rgba(245,158,11,0.15);color:var(--amber)}.badge-disabled{background:rgba(239,68,68,0.15);color:var(--red)}.badge-available{background:rgba(34,211,238,0.15);color:var(--accent)}.badge-claimed{background:rgba(245,158,11,0.15);color:var(--amber)}
.actions-cell{display:flex;gap:4px;flex-wrap:wrap}
.search-bar{position:relative;margin-bottom:16px}.search-bar input{width:100%;padding-left:36px}.search-bar svg{position:absolute;left:12px;top:50%;transform:translateY(-50%);width:16px;height:16px;color:var(--text-muted)}
.team-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);margin-bottom:16px;overflow:hidden}
.team-card-header{padding:16px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px}
.team-name{font-size:16px;font-weight:700;display:flex;align-items:center;gap:8px}
.team-color-dot{width:12px;height:12px;border-radius:50%;flex-shrink:0}
.team-meta{display:flex;gap:16px;font-size:13px;color:var(--text-dim);align-items:center}
.team-card-body{padding:16px}
.team-card-footer{padding:12px 16px;border-top:1px solid var(--border);display:flex;gap:8px;align-items:center}
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:1000;align-items:center;justify-content:center}.modal-overlay.active{display:flex}
.modal{background:var(--surface);border:1px solid var(--border);border-radius:12px;width:90%;max-width:480px;padding:24px}.modal h3{font-size:18px;margin-bottom:12px}.modal p{color:var(--text-dim);font-size:14px;margin-bottom:16px}.modal-actions{display:flex;gap:8px;justify-content:flex-end}
.login-overlay{position:fixed;inset:0;background:var(--bg);z-index:9999;display:flex;align-items:center;justify-content:center}.login-overlay.hidden{display:none}
.login-box{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:40px;width:90%;max-width:400px;text-align:center}
.login-box .logo{font-size:28px;margin-bottom:8px}.login-box .subtitle{color:var(--text-dim);font-size:14px;margin-bottom:24px}
.login-box input{width:100%;padding:12px;font-size:18px;text-align:center;letter-spacing:8px;margin-bottom:16px;font-family:var(--font-mono)}
.login-box .btn{width:100%;justify-content:center;padding:12px;font-size:15px}
.login-error{color:var(--red);font-size:13px;margin-top:12px;display:none}
.toast-container{position:fixed;top:16px;right:16px;z-index:10000;display:flex;flex-direction:column;gap:8px}
.toast{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:12px 16px;font-size:13px;display:flex;align-items:center;gap:8px;animation:toastIn 0.3s ease;max-width:360px}
.toast.success{border-left:3px solid var(--green)}.toast.error{border-left:3px solid var(--red)}.toast.info{border-left:3px solid var(--accent)}
@keyframes toastIn{from{opacity:0;transform:translateX(50px)}to{opacity:1;transform:translateX(0)}}
.section{display:none}.section.active{display:block}
@media(max-width:768px){.sidebar{width:60px}.sidebar .nav-item span,.sidebar-header .logo,.sidebar-footer>*:not(.status-dot){display:none}.main{margin-left:60px;padding:16px}.summary-grid{grid-template-columns:repeat(2,1fr)}.form-row{flex-direction:column}}
</style>
</head>
<body>

<div class="login-overlay" id="loginOverlay">
  <div class="login-box">
    <div style="margin-bottom:8px"><img class="logo-img-login" id="adminLoginLogo" alt="ARM Energy" src="data:image/png;base64,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" style="height:50px"></div>
    <div class="subtitle">Admin Dashboard</div>
    <input type="password" id="loginPin" placeholder="Admin PIN" maxlength="20" autocomplete="off">
    <button class="btn btn-primary" onclick="attemptLogin()">Authenticate</button>
    <div class="login-error" id="loginError">Invalid admin PIN</div>
  </div>
</div>

<aside class="sidebar">
  <div class="sidebar-header">
    <div style="display:flex;align-items:center;gap:8px"><img class="logo-img-sm" id="adminSidebarLogo" alt="ARM Energy" src="data:image/png;base64,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"><span class="admin-badge">ADMIN</span></div>
  </div>
  <nav class="sidebar-nav">
    <button class="nav-item active" data-section="traders" onclick="switchSection('traders')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 21v-2a4 4 0 00-4-4H6a4 4 0 00-4-4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"/></svg>
      <span>Traders</span>
      <span class="nav-badge" id="pendingBadge" style="display:none">0</span>
    </button>
    <button class="nav-item" data-section="teams" onclick="switchSection('teams')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
      <span>Teams</span>
    </button>
    <button class="nav-item" data-section="pins" onclick="switchSection('pins')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg>
      <span>PINs</span>
    </button>
    <button class="nav-item" data-section="system" onclick="switchSection('system')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 112.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 114 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"/></svg>
      <span>System</span>
    </button>
  </nav>
  <div class="sidebar-footer">
    <div class="server-status"><span class="status-dot" id="statusDot"></span><span id="statusText">Connecting...</span></div>
    <div class="theme-selector">
      <button class="theme-btn active" onclick="setTheme('dark')">Dark</button>
      <button class="theme-btn" onclick="setTheme('medium')">Med</button>
      <button class="theme-btn" onclick="setTheme('light')">Light</button>
    </div>
    <button class="logout-btn" onclick="logout()">Logout</button>
  </div>
</aside>

<main class="main">

  <!-- TRADERS SECTION -->
  <div class="section active" id="sec-traders">
    <div class="page-header"><h1>Trader Management</h1><p>Manage registered traders, approve pending accounts, and track performance.</p></div>
    <div class="summary-grid">
      <div class="summary-card"><div class="label">Total Traders</div><div class="value" id="statTotalTraders">0</div></div>
      <div class="summary-card"><div class="label">Active</div><div class="value green" id="statActiveTraders">0</div></div>
      <div class="summary-card"><div class="label">Pending</div><div class="value amber" id="statPendingTraders">0</div></div>
      <div class="summary-card"><div class="label">Combined P&amp;L</div><div class="value" id="statCombinedPnl">$0</div></div>
    </div>
    <div class="card"><div class="card-header"><h3>Add New Trader</h3></div><div class="card-body">
      <div class="form-row">
        <div class="form-group"><label>Full Name</label><input id="newTraderName" placeholder="John Doe"></div>
        <div class="form-group"><label>Role</label><input id="newTraderFirm" placeholder="Trader, Analyst, etc."></div>
        <div class="form-group"><label>Login PIN (4 digits)</label><input id="newTraderPin" maxlength="4" placeholder="Auto-generate"></div>
        <button class="btn btn-primary" onclick="addTrader()" style="height:36px">Add Trader</button>
      </div>
    </div></div>
    <div style="display:flex;gap:12px;margin-bottom:16px">
      <button class="btn btn-success" id="approveAllBtn" onclick="approveAllPending()" style="display:none">Approve All Pending (<span id="approveAllCount">0</span>)</button>
    </div>
    <div class="search-bar">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
      <input id="traderSearch" placeholder="Search traders..." oninput="filterTraders()">
    </div>
    <div class="card"><div class="table-wrap"><table>
      <thead><tr><th>Name</th><th>Role</th><th>Team</th><th>PIN</th><th>Status</th><th>Trades</th><th>P&amp;L</th><th>Balance</th><th>Last Seen</th><th>Actions</th></tr></thead>
      <tbody id="traderTableBody"></tbody>
    </table></div></div>
  </div>

  <!-- TEAMS SECTION -->
  <div class="section" id="sec-teams">
    <div class="page-header"><h1>Team Management</h1><p>Create and manage trading teams, assign members, and track team performance.</p></div>
    <div class="summary-grid">
      <div class="summary-card"><div class="label">Total Teams</div><div class="value" id="statTotalTeams">0</div></div>
      <div class="summary-card"><div class="label">Unaffiliated Traders</div><div class="value" id="statUnaffiliatedTraders">0</div></div>
    </div>
    <div class="card"><div class="card-header"><h3>Create Team</h3></div><div class="card-body">
      <div class="form-row">
        <div class="form-group"><label>Team Name</label><input id="newTeamName" placeholder="Alpha Team"></div>
        <div class="form-group"><label>Description</label><input id="newTeamDesc" placeholder="Optional description"></div>
        <div class="form-group" style="flex:0"><label>Color</label><input type="color" id="newTeamColor" value="#22d3ee"></div>
        <button class="btn btn-primary" onclick="createTeam()" style="height:36px">Create</button>
      </div>
    </div></div>
    <div id="teamsContainer"></div>
  </div>

  <!-- PINS SECTION -->
  <div class="section" id="sec-pins">
    <div class="page-header"><h1>PIN Management</h1><p>Generate and manage registration PINs for traders.</p></div>
    <div class="summary-grid">
      <div class="summary-card"><div class="label">Total PINs</div><div class="value" id="statTotalPins">0</div></div>
      <div class="summary-card"><div class="label">Available</div><div class="value green" id="statAvailablePins">0</div></div>
      <div class="summary-card"><div class="label">Claimed</div><div class="value amber" id="statClaimedPins">0</div></div>
      <div class="summary-card"><div class="label">Disabled</div><div class="value red" id="statDisabledPins">0</div></div>
    </div>
    <div class="card"><div class="card-header"><h3>Generate PINs</h3></div><div class="card-body">
      <div class="form-row">
        <div class="form-group"><label>Quantity (1-50)</label><input type="number" id="pinQuantity" value="10" min="1" max="50"></div>
        <button class="btn btn-primary" onclick="generatePins()" style="height:36px">Generate</button>
      </div>
    </div></div>
    <div class="card"><div class="table-wrap"><table>
      <thead><tr><th>PIN</th><th>Status</th><th>Claimed By</th><th>Created</th><th>Actions</th></tr></thead>
      <tbody id="pinTableBody"></tbody>
    </table></div></div>
  </div>

  <!-- SYSTEM SECTION -->
  <div class="section" id="sec-system">
    <div class="page-header"><h1>System Settings</h1><p>Server configuration, bulk operations, and admin settings.</p></div>
    <div class="summary-grid">
      <div class="summary-card"><div class="label">Server Status</div><div class="value green" id="sysServerStatus">Online</div></div>
      <div class="summary-card"><div class="label">Connected Clients</div><div class="value" id="sysConnectedClients">0</div></div>
      <div class="summary-card"><div class="label">Server Time</div><div class="value" id="sysServerTime" style="font-size:16px">—</div></div>
    </div>
    <div class="card"><div class="card-header"><h3>Change Admin PIN</h3></div><div class="card-body">
      <div class="form-row">
        <div class="form-group"><label>Current PIN</label><input type="password" id="currentAdminPin" placeholder="Current PIN"></div>
        <div class="form-group"><label>New PIN</label><input type="password" id="newAdminPin" placeholder="New PIN"></div>
        <div class="form-group"><label>Confirm New PIN</label><input type="password" id="confirmAdminPin" placeholder="Confirm"></div>
        <button class="btn btn-warning" onclick="changeAdminPin()" style="height:36px">Change PIN</button>
      </div>
    </div></div>
    <div class="card"><div class="card-header"><h3>Bulk Operations</h3></div><div class="card-body">
      <div style="display:flex;gap:12px;flex-wrap:wrap">
        <button class="btn btn-danger" onclick="confirmResetAll()">Reset All Traders</button>
        <button class="btn btn-ghost" onclick="exportTrades()">Export All Trades (CSV)</button>
      </div>
    </div></div>
    <div class="card"><div class="card-header"><h3>Chat Moderation</h3></div><div class="card-body">
      <p style="font-size:12px;color:var(--text-dim);margin-bottom:12px">Words and phrases listed below will be automatically censored (replaced with asterisks) in all chat messages. One entry per line. Case-insensitive.</p>
      <textarea id="censoredWords" style="width:100%;min-height:120px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text);padding:10px;font-size:13px;font-family:monospace;resize:vertical" placeholder="Enter one word or phrase per line..."></textarea>
      <div style="display:flex;gap:8px;margin-top:8px;align-items:center">
        <button class="btn btn-primary" onclick="saveCensoredWords()">Save Censored Words</button>
        <span id="censorCount" style="font-size:12px;color:var(--text-dim)"></span>
      </div>
    </div></div>
    <div class="card"><div class="card-header"><h3>Configuration</h3></div><div class="card-body" id="configDisplay"><p style="color:var(--text-dim)">Loading configuration...</p></div></div>
  </div>

</main>

<div class="modal-overlay" id="confirmModal">
  <div class="modal">
    <h3 id="confirmTitle">Confirm Action</h3>
    <p id="confirmMessage">Are you sure?</p>
    <div class="modal-actions">
      <button class="btn btn-ghost" onclick="closeModal()">Cancel</button>
      <button class="btn btn-danger" id="confirmAction">Confirm</button>
    </div>
  </div>
</div>

<div class="toast-container" id="toastContainer"></div>

<script>
let adminPin=localStorage.getItem('ng_admin_pin')||'';
let traders=[],teams=[],pins=[],serverOnline=false;

function attemptLogin(){
  const pin=document.getElementById('loginPin').value.trim();
  if(!pin)return;
  adminPin=pin;
  testAuth(pin).then(ok=>{
    if(ok){localStorage.setItem('ng_admin_pin',pin);document.getElementById('loginOverlay').classList.add('hidden');loadAllData()}
    else document.getElementById('loginError').style.display='block';
  });
}
async function testAuth(pin){try{const r=await fetch('/api/admin/traders',{headers:{'X-Admin-Pin':pin}});return r.ok}catch{return false}}
function logout(){localStorage.removeItem('ng_admin_pin');adminPin='';document.getElementById('loginOverlay').classList.remove('hidden');document.getElementById('loginPin').value='';document.getElementById('loginError').style.display='none'}
document.getElementById('loginPin').addEventListener('keydown',e=>{if(e.key==='Enter')attemptLogin()});

function setTheme(theme){
  if(theme==='dark')document.documentElement.removeAttribute('data-theme');
  else document.documentElement.setAttribute('data-theme',theme);
  localStorage.setItem('ng_theme',theme);
  document.querySelectorAll('.theme-btn').forEach(btn=>{
    const t=btn.textContent.trim().toLowerCase();
    btn.classList.toggle('active',(t==='dark'&&theme==='dark')||(t==='med'&&theme==='medium')||(t==='light'&&theme==='light'));
  });
}
(function(){setTheme(localStorage.getItem('ng_theme')||'dark')})();

function switchSection(name){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  document.getElementById('sec-'+name).classList.add('active');
  document.querySelector('.nav-item[data-section="'+name+'"]').classList.add('active');
}

function api(url,opts={}){opts.headers={...opts.headers,'X-Admin-Pin':adminPin,'Content-Type':'application/json'};return fetch(url,opts).then(r=>r.json())}
function toast(msg,type='info'){const c=document.getElementById('toastContainer'),t=document.createElement('div');t.className='toast '+type;t.textContent=msg;c.appendChild(t);setTimeout(()=>{t.style.opacity='0';setTimeout(()=>t.remove(),300)},3500)}
function showModal(title,message,onConfirm){document.getElementById('confirmTitle').textContent=title;document.getElementById('confirmMessage').textContent=message;document.getElementById('confirmAction').onclick=()=>{closeModal();onConfirm()};document.getElementById('confirmModal').classList.add('active')}
function closeModal(){document.getElementById('confirmModal').classList.remove('active')}

async function loadAllData(){await Promise.all([loadTraders(),loadTeams(),loadPins(),loadConfig(),loadCensoredWords(),checkStatus()])}

async function checkStatus(){
  try{
    const r=await fetch('/api/status'),d=await r.json();serverOnline=true;
    document.getElementById('statusDot').className='status-dot';
    document.getElementById('statusText').textContent='Online \u00b7 '+d.active_traders+' traders';
    document.getElementById('sysServerStatus').textContent='Online';document.getElementById('sysServerStatus').className='value green';
    document.getElementById('sysConnectedClients').textContent=d.connected_clients||0;
    document.getElementById('sysServerTime').textContent=new Date(d.server_time).toLocaleString();
  }catch{
    serverOnline=false;document.getElementById('statusDot').className='status-dot offline';
    document.getElementById('statusText').textContent='Offline';
    document.getElementById('sysServerStatus').textContent='Offline';document.getElementById('sysServerStatus').className='value red';
  }
}

async function loadTraders(){try{const d=await api('/api/admin/traders');if(!d.success)return;traders=d.traders;renderTraders()}catch(e){console.error('Load traders error:',e)}}
function renderTraders(){
  const total=traders.length,active=traders.filter(t=>t.status==='ACTIVE').length,pending=traders.filter(t=>t.status==='PENDING').length;
  const pnl=traders.reduce((s,t)=>s+(t.realized_pnl||0),0);
  document.getElementById('statTotalTraders').textContent=total;
  document.getElementById('statActiveTraders').textContent=active;
  document.getElementById('statPendingTraders').textContent=pending;
  const pnlEl=document.getElementById('statCombinedPnl');
  pnlEl.textContent='$'+pnl.toLocaleString(undefined,{minimumFractionDigits:0,maximumFractionDigits:0});
  pnlEl.className='value '+(pnl>=0?'green':'red');
  const badge=document.getElementById('pendingBadge');
  if(pending>0){badge.style.display='flex';badge.textContent=pending}else badge.style.display='none';
  const approveBtn=document.getElementById('approveAllBtn');
  if(pending>0){approveBtn.style.display='inline-flex';document.getElementById('approveAllCount').textContent=pending}else approveBtn.style.display='none';
  renderTraderTable(traders);
}
function renderTraderTable(list){
  const search=(document.getElementById('traderSearch').value||'').toLowerCase();
  if(search)list=list.filter(t=>t.display_name.toLowerCase().includes(search)||t.firm.toLowerCase().includes(search)||(t.team_name||'').toLowerCase().includes(search));
  const tbody=document.getElementById('traderTableBody');
  tbody.innerHTML=list.map(t=>{
    const sc=t.status==='ACTIVE'?'badge-active':t.status==='PENDING'?'badge-pending':'badge-disabled';
    const pc=(t.realized_pnl||0)>=0?'color:var(--green)':'color:var(--red)';
    const ls=t.last_seen?new Date(t.last_seen).toLocaleString():'Never';
    const tb=t.team_name?'<span style="display:inline-flex;align-items:center;gap:4px"><span style="width:8px;height:8px;border-radius:50%;background:'+(t.team_color||'#22d3ee')+'"></span>'+t.team_name+'</span>':'<span style="color:var(--text-muted)">\u2014</span>';
    let a='';
    if(t.status==='PENDING')a+='<button class="btn btn-success btn-sm" onclick="approveTrader('+t.id+')">Approve</button>';
    if(t.status==='ACTIVE')a+='<button class="btn btn-ghost btn-sm" onclick="disableTrader('+t.id+')">Disable</button>';
    if(t.status==='DISABLED')a+='<button class="btn btn-ghost btn-sm" onclick="enableTrader('+t.id+')">Enable</button>';
    a+='<button class="btn btn-ghost btn-sm" onclick="resetTrader('+t.id+',\''+t.display_name.replace(/'/g,"\\'")+'\')">Reset</button>';
    a+='<button class="btn btn-ghost btn-sm" onclick="changeTraderPin('+t.id+',\''+t.display_name.replace(/'/g,"\\'")+'\')" title="Change PIN">PIN</button>';
    a+='<button class="btn btn-ghost btn-sm" onclick="adjustBalance('+t.id+','+t.starting_balance+')">Balance</button>';
    a+='<button class="btn btn-ghost btn-sm" style="color:var(--red)" onclick="deleteTrader('+t.id+',\''+t.display_name.replace(/'/g,"\\'")+'\')">Delete</button>';
    const pinCell='<span style="font-family:monospace;cursor:pointer;background:var(--bg);padding:2px 6px;border-radius:4px;color:transparent;text-shadow:0 0 5px var(--text-muted)" onclick="this.style.color=\'var(--text)\';this.style.textShadow=\'none\'" title="Click to reveal">'+(t.pin||'????')+'</span>';
    return '<tr><td><strong>'+t.display_name+'</strong></td><td>'+(t.firm||'\u2014')+'</td><td>'+tb+'</td><td>'+pinCell+'</td><td><span class="badge '+sc+'">'+t.status+'</span></td><td>'+t.trade_count+'</td><td style="'+pc+'">$'+(t.realized_pnl||0).toLocaleString(undefined,{minimumFractionDigits:0,maximumFractionDigits:0})+'</td><td>$'+(t.starting_balance||1000000).toLocaleString()+'</td><td style="font-size:12px;color:var(--text-dim)">'+ls+'</td><td><div class="actions-cell">'+a+'</div></td></tr>';
  }).join('');
}
function filterTraders(){renderTraderTable(traders)}
async function addTrader(){
  const name=document.getElementById('newTraderName').value.trim(),firm=document.getElementById('newTraderFirm').value.trim();
  let pin=document.getElementById('newTraderPin').value.trim();
  if(!name)return toast('Name is required','error');
  if(!pin)pin=String(Math.floor(1000+Math.random()*9000));
  const d=await api('/api/traders/register',{method:'POST',body:JSON.stringify({real_name:name,display_name:name,firm:firm,pin:pin})});
  if(d.success){toast('Trader added: '+name+' (PIN: '+pin+')','success');document.getElementById('newTraderName').value='';document.getElementById('newTraderFirm').value='';document.getElementById('newTraderPin').value='';loadTraders()}
  else toast(d.error||'Failed','error');
}
async function approveTrader(id){await api('/api/admin/traders/approve/'+id,{method:'POST'});toast('Trader approved','success');loadTraders()}
async function disableTrader(id){await api('/api/admin/traders/disable/'+id,{method:'POST'});toast('Trader disabled','info');loadTraders()}
async function enableTrader(id){await api('/api/admin/traders/enable/'+id,{method:'POST'});toast('Trader enabled','success');loadTraders()}
function resetTrader(id,name){showModal('Reset Trader','Reset all trades for "'+name+'"? This cannot be undone.',async()=>{await api('/api/admin/traders/reset/'+id,{method:'POST'});toast('Trades reset for '+name,'success');loadTraders()})}
function deleteTrader(id,name){showModal('Delete Trader','Permanently delete "'+name+'" and all their trades?',async()=>{await api('/api/admin/traders/'+id,{method:'DELETE'});toast('Trader deleted: '+name,'success');loadTraders()})}
function adjustBalance(id,current){const nb=prompt('Enter new starting balance:',current);if(nb===null)return;const v=parseFloat(nb);if(isNaN(v)||v<=0)return toast('Invalid balance','error');api('/api/admin/traders/balance/'+id,{method:'POST',body:JSON.stringify({starting_balance:v})}).then(()=>{toast('Balance updated','success');loadTraders()})}
function changeTraderPin(id,name){const np=prompt('Enter new 4-digit PIN for "'+name+'":');if(!np)return;if(!/^\d{4}$/.test(np.trim()))return toast('PIN must be exactly 4 digits','error');api('/api/admin/traders/pin/'+id,{method:'POST',body:JSON.stringify({pin:np.trim()})}).then(d=>{if(d.success){toast('PIN updated for '+name+': '+np.trim(),'success');loadTraders()}else{toast(d.error||'Failed to change PIN','error')}})}
async function approveAllPending(){const p=traders.filter(t=>t.status==='PENDING');for(const t of p)await api('/api/admin/traders/approve/'+t.id,{method:'POST'});toast('Approved '+p.length+' traders','success');loadTraders()}

async function loadTeams(){try{const d=await api('/api/admin/teams');if(!d.success)return;teams=d.teams;renderTeams()}catch(e){console.error('Load teams error:',e)}}
function renderTeams(){
  document.getElementById('statTotalTeams').textContent=teams.length;
  const affiliated=new Set();teams.forEach(t=>t.members.forEach(m=>affiliated.add(m.id)));
  const unaffiliated=traders.filter(t=>!affiliated.has(t.id));
  document.getElementById('statUnaffiliatedTraders').textContent=unaffiliated.length;
  const container=document.getElementById('teamsContainer');
  if(!teams.length){container.innerHTML='<div class="card"><div class="card-body" style="text-align:center;padding:40px;color:var(--text-muted)">No teams created yet.</div></div>';return}
  container.innerHTML=teams.map(team=>{
    const mhtml=team.members.length?team.members.map(m=>{
      const ot=teams.filter(t=>t.id!==team.id);
      const to=ot.map(o=>'<option value="'+o.id+'">'+o.name+'</option>').join('');
      return '<tr><td>'+m.display_name+'</td><td>'+(m.firm||'\u2014')+'</td><td><span class="badge '+(m.status==='ACTIVE'?'badge-active':m.status==='PENDING'?'badge-pending':'badge-disabled')+'">'+m.status+'</span></td><td><div class="actions-cell"><button class="btn btn-ghost btn-sm" onclick="removeFromTeam('+team.id+','+m.id+')">Remove</button>'+(ot.length?'<select onchange="transferTrader('+m.id+',this.value)" style="font-size:11px;padding:2px 4px;background:var(--surface2);border:1px solid var(--border);color:var(--text-dim);border-radius:4px"><option value="">Transfer to...</option>'+to+'</select>':'')+'</div></td></tr>';
    }).join(''):'<tr><td colspan="4" style="color:var(--text-muted);text-align:center;padding:20px">No members</td></tr>';
    const uo=unaffiliated.map(u=>'<option value="'+u.id+'">'+u.display_name+'</option>').join('');
    return '<div class="team-card"><div class="team-card-header"><div class="team-name"><span class="team-color-dot" style="background:'+team.color+'"></span>'+team.name+'</div><div class="team-meta"><span>'+team.member_count+' members</span><button class="btn btn-ghost btn-sm" onclick="editTeam('+team.id+',\''+team.name.replace(/'/g,"\\'")+'\',\''+team.description.replace(/'/g,"\\'")+'\',\''+team.color+'\')">Edit</button><button class="btn btn-ghost btn-sm" style="color:var(--red)" onclick="deleteTeam('+team.id+',\''+team.name.replace(/'/g,"\\'")+'\')">Delete</button></div></div><div class="team-card-body">'+(team.description?'<p style="color:var(--text-dim);font-size:13px;margin-bottom:12px">'+team.description+'</p>':'')+'<div class="table-wrap"><table><thead><tr><th>Trader</th><th>Role</th><th>Status</th><th>Actions</th></tr></thead><tbody>'+mhtml+'</tbody></table></div></div>'+(unaffiliated.length?'<div class="team-card-footer"><select id="assign-'+team.id+'" style="flex:1;font-size:13px"><option value="">Assign trader...</option>'+uo+'</select><button class="btn btn-primary btn-sm" onclick="assignToTeam('+team.id+')">Assign</button></div>':'')+'</div>';
  }).join('');
}
async function createTeam(){
  const name=document.getElementById('newTeamName').value.trim();if(!name)return toast('Team name is required','error');
  const d=await api('/api/admin/teams',{method:'POST',body:JSON.stringify({name:name,description:document.getElementById('newTeamDesc').value.trim(),color:document.getElementById('newTeamColor').value})});
  if(d.success){toast('Team created: '+name,'success');document.getElementById('newTeamName').value='';document.getElementById('newTeamDesc').value='';loadTeams()}else toast(d.error||'Failed','error');
}
function editTeam(id,name,desc,color){const nn=prompt('Team name:',name);if(nn===null)return;const nd=prompt('Description:',desc),nc=prompt('Color hex:',color);api('/api/admin/teams/'+id,{method:'PUT',body:JSON.stringify({name:nn||name,description:nd||desc,color:nc||color})}).then(()=>{toast('Team updated','success');loadTeams()})}
function deleteTeam(id,name){showModal('Delete Team','Delete "'+name+'"? Members will become unaffiliated.',async()=>{await api('/api/admin/teams/'+id,{method:'DELETE'});toast('Team deleted','success');loadTeams()})}
async function assignToTeam(tid){const sel=document.getElementById('assign-'+tid),v=sel.value;if(!v)return;await api('/api/admin/teams/'+tid+'/assign',{method:'POST',body:JSON.stringify({trader_id:parseInt(v)})});toast('Trader assigned','success');loadTraders();loadTeams()}
async function removeFromTeam(tid,uid){await api('/api/admin/teams/'+tid+'/remove',{method:'POST',body:JSON.stringify({trader_id:uid})});toast('Trader removed','success');loadTraders();loadTeams()}
async function transferTrader(uid,toTid){if(!toTid)return;await api('/api/admin/teams/transfer',{method:'POST',body:JSON.stringify({trader_id:uid,to_team_id:parseInt(toTid)})});toast('Trader transferred','success');loadTraders();loadTeams()}

async function loadPins(){try{const d=await api('/api/admin/pins');if(!d.success)return;pins=d.pins;renderPins()}catch(e){console.error('Load pins error:',e)}}
function renderPins(){
  const total=pins.length,avail=pins.filter(p=>p.status==='AVAILABLE').length,claimed=pins.filter(p=>p.status==='CLAIMED').length,disabled=pins.filter(p=>p.status==='DISABLED').length;
  document.getElementById('statTotalPins').textContent=total;document.getElementById('statAvailablePins').textContent=avail;
  document.getElementById('statClaimedPins').textContent=claimed;document.getElementById('statDisabledPins').textContent=disabled;
  const tbody=document.getElementById('pinTableBody');
  if(!pins.length){tbody.innerHTML='<tr><td colspan="5" style="text-align:center;color:var(--text-muted);padding:20px">No PINs generated yet</td></tr>';return}
  tbody.innerHTML=pins.map(p=>{
    const sc=p.status==='AVAILABLE'?'badge-available':p.status==='CLAIMED'?'badge-claimed':'badge-disabled';
    const act=p.status==='AVAILABLE'?'<button class="btn btn-ghost btn-sm" style="color:var(--red)" onclick="revokePin(\''+p.pin+'\')">Revoke</button>':'';
    return '<tr><td style="font-family:var(--font-mono);letter-spacing:2px">'+p.pin+'</td><td><span class="badge '+sc+'">'+p.status+'</span></td><td>'+(p.claimed_by||'\u2014')+'</td><td style="font-size:12px;color:var(--text-dim)">'+new Date(p.created_at).toLocaleString()+'</td><td>'+act+'</td></tr>';
  }).join('');
}
async function generatePins(){const qty=parseInt(document.getElementById('pinQuantity').value)||10;const d=await api('/api/admin/pins/generate',{method:'POST',body:JSON.stringify({quantity:qty})});if(d.success){toast('Generated '+d.count+' PINs','success');loadPins()}else toast(d.error||'Failed','error')}
async function revokePin(pin){await api('/api/admin/pins/revoke',{method:'POST',body:JSON.stringify({pin:pin})});toast('PIN revoked','info');loadPins()}

async function loadConfig(){
  try{const d=await api('/api/admin/config');if(!d.success)return;const c=d.config;
    document.getElementById('configDisplay').innerHTML='<div style="display:grid;grid-template-columns:200px 1fr;gap:8px;font-size:13px"><span style="color:var(--text-dim)">Admin PIN:</span><span style="font-family:var(--font-mono)">'+c.admin_pin+'</span><span style="color:var(--text-dim)">EIA API Key:</span><span style="font-family:var(--font-mono)">'+c.eia_api_key+'</span><span style="color:var(--text-dim)">Database:</span><span style="font-family:var(--font-mono);word-break:break-all">'+c.database+'</span><span style="color:var(--text-dim)">News Cache TTL:</span><span>'+c.news_cache_ttl+'s</span></div>';
  }catch(e){console.error('Load config error:',e)}
}
async function changeAdminPin(){
  const cur=document.getElementById('currentAdminPin').value,np=document.getElementById('newAdminPin').value,cp=document.getElementById('confirmAdminPin').value;
  if(!cur||!np||!cp)return toast('All fields are required','error');
  if(np!==cp)return toast('New PINs do not match','error');
  if(np.length<4)return toast('PIN must be at least 4 characters','error');
  try{const r=await fetch('/api/admin/change-pin',{method:'POST',headers:{'X-Admin-Pin':cur,'Content-Type':'application/json'},body:JSON.stringify({new_pin:np,confirm_pin:cp})});const d=await r.json();
    if(d.success){adminPin=np;localStorage.setItem('ng_admin_pin',np);toast('Admin PIN changed successfully','success');document.getElementById('currentAdminPin').value='';document.getElementById('newAdminPin').value='';document.getElementById('confirmAdminPin').value='';loadConfig()}
    else toast(d.error||'Failed to change PIN','error');
  }catch{toast('Server error','error')}
}
function confirmResetAll(){showModal('Reset All Traders','This will delete ALL trades and performance snapshots. This cannot be undone.',async()=>{await api('/api/admin/reset-all',{method:'POST'});toast('All traders reset','success');loadTraders()})}
function exportTrades(){fetch('/api/admin/export',{headers:{'X-Admin-Pin':adminPin}}).then(r=>r.blob()).then(blob=>{const url=URL.createObjectURL(blob),a=document.createElement('a');a.href=url;a.download='energy_desk_trades.csv';a.click();URL.revokeObjectURL(url)})}

async function loadCensoredWords(){
  try{
    const r=await fetch('/api/admin/censored-words',{headers:{'X-Admin-Pin':adminPin}});
    const d=await r.json();
    if(d.success){
      const ta=document.getElementById('censoredWords');
      if(ta)ta.value=(d.words||[]).join('\n');
      const ct=document.getElementById('censorCount');
      if(ct)ct.textContent=d.words.length+' word'+(d.words.length!==1?'s':'')+' active';
    }
  }catch(e){}
}

async function saveCensoredWords(){
  const ta=document.getElementById('censoredWords');
  const lines=(ta.value||'').split('\n').map(l=>l.trim()).filter(l=>l.length>0);
  try{
    const r=await fetch('/api/admin/censored-words',{
      method:'POST',headers:{'Content-Type':'application/json','X-Admin-Pin':adminPin},
      body:JSON.stringify({words:lines})
    });
    const d=await r.json();
    if(d.success){
      toast('Saved '+d.count+' censored word'+(d.count!==1?'s':''),'success');
      const ct=document.getElementById('censorCount');
      if(ct)ct.textContent=d.count+' word'+(d.count!==1?'s':'')+' active';
    }else{toast(d.error||'Failed to save','error');}
  }catch(e){toast('Error saving censored words','error');}
}


const ADMIN_LOGO = 'data:image/png;base64,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';
document.querySelectorAll('.logo-img-sm,.logo-img-login').forEach(img => img.src = ADMIN_LOGO);

(async function init(){
  if(adminPin){const ok=await testAuth(adminPin);if(ok){document.getElementById('loginOverlay').classList.add('hidden');loadAllData()}else{localStorage.removeItem('ng_admin_pin');adminPin=''}}
  setInterval(()=>{if(adminPin){checkStatus();loadTraders()}},30000);
})();
</script>
</body>
</html>
